<!DOCTYPE html><html lang="en">

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Use CSP as the modern approach to securing our web applications">
  <meta name="robots" content="noindex">
  
  <title>
Content Security Policy - NHSBSA Digital, Data and Technology Playbook - NHSBSA
  </title>

    
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-NQ562NM01Z" type="text/plain" data-cookieconsent="statistics"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-NQ562NM01Z');
    </script>

  
  <link href="https://assets.nhs.uk/" rel="preconnect" crossorigin>
  <link type="font/woff2" href="https://assets.nhs.uk/fonts/FrutigerLTW01-55Roman.woff2" rel="preload" as="font" crossorigin>
  <link type="font/woff2" href="https://assets.nhs.uk/fonts/FrutigerLTW01-65Bold.woff2" rel="preload" as="font" crossorigin>

  
  <link rel="shortcut icon" href="/nhsbsa-digital-playbook/nhsuk-frontend/assets/favicons/favicon.ico?v=68c7f017cfba" type="image/x-icon">
  <link rel="apple-touch-icon" href="/nhsbsa-digital-playbook/nhsuk-frontend/assets/favicons/apple-touch-icon-180x180.png?v=15a5044def06">
  <link rel="mask-icon" href="/nhsbsa-digital-playbook/nhsuk-frontend/assets/favicons/favicon.svg" color="#005eb8">
  <link rel="icon" sizes="192x192" href="/nhsbsa-digital-playbook/nhsuk-frontend/assets/favicons/favicon-192x192.png?v=43924bfe6c7e">

  <meta name="msapplication-TileImage" content="/nhsbsa-digital-playbook/nhsuk-frontend/assets/favicons/mediumtile-144x144.png?v=cf4985872492">
  <meta name="msapplication-TileColor" content="#005eb8">
  <meta name="msapplication-square70x70logo" content="/nhsbsa-digital-playbook/nhsuk-frontend/assets/favicons/smalltile-70x70.png?v=29f75b06cf75">
  <meta name="msapplication-square150x150logo" content="/nhsbsa-digital-playbook/nhsuk-frontend/assets/favicons/mediumtile-150x150.png?v=89688d93af5b">
  <meta name="msapplication-wide310x150logo" content="/nhsbsa-digital-playbook/nhsuk-frontend/assets/favicons/widetile-310x150.png?v=535c3996630d">
  <meta name="msapplication-square310x310logo" content="/nhsbsa-digital-playbook/nhsuk-frontend/assets/favicons/largetile-310x310.png?v=294742e00ff4">

  <meta property="og:url" content="https://nhsbsa.github.io/nhsbsa-digital-playbook/security/content-security-policy/">
  <meta property="og:site_name" content="nhsbsa.nhs.uk">
  <meta property="og:description" content="Use CSP as the modern approach to securing our web applications">
  <meta property="og:type" content="website">
  <meta property="og:locale" content="en_GB">
  <meta property="og:image" content="https://nhsbsa.github.io/nhsbsa-digital-playbook/images/opengraph-image.png?v=b6b84e727630">
  <meta property="og:title" content="Content Security Policy - NHSBSA Digital, Data and Technology Playbook - NHSBSA">

  <link href="/nhsbsa-digital-playbook/stylesheets/application.css?v=a812fa0873c9" media="all" rel="stylesheet" type="text/css" >

</head>

<body class="">

  <script>document.body.className = ((document.body.className) ? document.body.className + ' js-enabled' : 'js-enabled');</script>
  
    
<div id="nhsuk-cookie-banner" data-nosnippet="true" >
    <div class="nhsuk-cookie-banner" id="cookiebanner" style="display:none;" data-cookie-version="1" data-policy-url="/nhsbsa-digital-playbook/cookie-policy/">
        <div class="nhsuk-width-container app-width-container">
                <h2>NHSBSA Digital, Data and Technology Playbook</h2>
                    <p>We've put some small files called cookies on your device to make our site work.</p>
                    <p>We'd also like to use analytics cookies. These send anonymous information about how our site is used to a service called Google Analytics. We use this information to improve our site.</p>
                    <p>Let us know if this is OK. We'll use a cookie to save your choice across all our digital services for the next 3 calendar months. You can <a id="nhsuk-cookie-banner__link" href="/nhsbsa-digital-playbook/cookie-policy/" data-policy-url=/nhsbsa-digital-playbook/cookie-policy/">read more about our cookies</a> before you choose.</p>

            <ul>
                <li>
                    <button class='nhsuk-button' id="nhsuk-cookie-banner__link_accept_analytics" href="#">I&#39;m OK with analytics cookies</button>
                </li>
                <li>
                    <button class='nhsuk-button' id="nhsuk-cookie-banner__link_accept" href="#">Do not use analytics cookies</button>
                </li>
            </ul>
        </div>
    </div>

    <div class="nhsuk-success-banner" id="nhsuk-cookie-confirmation-banner" style="display:none;">
        <div class="nhsuk-width-container">
            <p id="nhsuk-success-banner__message">You can change your cookie settings at any time using <a id="nhsuk-cookie-banner__link" href="/nhsbsa-digital-playbook/cookie-policy/" data-policy-url=/nhsbsa-digital-playbook/cookie-policy/">our cookies page</a>.</p>
        </div>
    </div>
</div>


    <a class="nhsuk-skip-link" href="#main-content">Skip to main content</a>


    


<header class="nhsuk-header nhsuk-header--organisation" role="banner">
  
  <div class="nhsuk-header__container">
    <div class="nhsuk-header__logo nhsuk-header__logo--only">      <a class="nhsuk-header__link" href="/nhsbsa-digital-playbook/" aria-label="Business Services Authority  Digital, Data and Technology playbook homepage">  <svg class="nhsuk-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 16" height="40" width="100">
    <path class="nhsuk-logo__background" fill="#005eb8" d="M0 0h40v16H0z"></path>
    <path class="nhsuk-logo__text" fill="#fff" d="M3.9 1.5h4.4l2.6 9h.1l1.8-9h3.3l-2.8 13H9l-2.7-9h-.1l-1.8 9H1.1M17.3 1.5h3.6l-1 4.9h4L25 1.5h3.5l-2.7 13h-3.5l1.1-5.6h-4.1l-1.2 5.6h-3.4M37.7 4.4c-.7-.3-1.6-.6-2.9-.6-1.4 0-2.5.2-2.5 1.3 0 1.8 5.1 1.2 5.1 5.1 0 3.6-3.3 4.5-6.4 4.5-1.3 0-2.9-.3-4-.7l.8-2.7c.7.4 2.1.7 3.2.7s2.8-.2 2.8-1.5c0-2.1-5.1-1.3-5.1-5 0-3.4 2.9-4.4 5.8-4.4 1.6 0 3.1.2 4 .6"></path>
  </svg>

        <span class="nhsuk-organisation-name">Business Services Authority</span>
<span class="nhsuk-organisation-descriptor">Digital, Data and Technology playbook</span>      </a>    </div>
    </div>
    

</header>

<div class="nhsuk-width-container app-width-container">
    <main class="nhsuk-main-wrapper app-main-wrapper" id="main-content" role="main">
<div class="nhsuk-grid-row">
  <div class="nhsuk-width-container app-width-container">
    <div class="app-pane">
      <div class="app-pane__side-bar">
        <nav class="app-side-nav">
        <h2 class="app-side-nav__heading">Contents</h2>
        <div class="nhsbsa-nav__list">
                <ol>
                    
                    <li><a href="#start-early">Start early</a>
            		</li>

                    <li><a href="#csp-header">CSP Header</a>
            		</li>

                    <li><a href="#csp-levels">CSP levels</a>
            		</li>

                    <li><a href="#browser-support">Browser support</a>
            		</li>

                    <li><a href="#csp-evaluator">CSP Evaluator</a>
            		</li>

                    <li><a href="#hash-and-nonce">Hash and nonce</a>
            		</li>

                    <li><a href="#framework-support">Framework support</a>
            
                <ol>
                    
                    <li><a href="#nodejs">Node.js</a>
            		</li>

                    <li><a href="#java/spring">Java/Spring</a>
            		</li>
                </ol>
            		</li>

                    <li><a href="#inline-scripts">Inline scripts</a>
            		</li>

                    <li><a href="#reporting">Reporting</a>
            		</li>

                    <li><a href="#example-csp">Example CSP</a>
            		</li>

                    <li><a href="#must">MUST</a>
            
                <ol>
                    
                    <li><a href="#default-src">default-src</a>
            		</li>

                    <li><a href="#frame-ancestors">frame-ancestors</a>
            		</li>

                    <li><a href="#base-uri">base-uri</a>
            		</li>

                    <li><a href="#form-action">form-action</a>
            		</li>

                    <li><a href="#plugin-types">plugin-types</a>
            		</li>

                    <li><a href="#prefetch-src">prefetch-src</a>
            		</li>
                </ol>
            		</li>

                    <li><a href="#should">SHOULD</a>
            
                <ol>
                    
                    <li><a href="#script-src">script-src</a>
            		</li>

                    <li><a href="#style-src">style-src</a>
            		</li>

                    <li><a href="#img-src">img-src</a>
            		</li>

                    <li><a href="#font-src">font-src</a>
            		</li>

                    <li><a href="#report-uri">report-uri</a>
            		</li>
                </ol>
            		</li>

                    <li><a href="#could">COULD</a>
            
                <ol>
                    
                    <li><a href="#connect-src">connect-src</a>
            		</li>

                    <li><a href="#media-src">media-src</a>
            		</li>

                    <li><a href="#upgrade-insecure-requests">upgrade-insecure-requests</a>
            		</li>

                    <li><a href="#report-to">report-to</a>
            		</li>

                    <li><a href="#sandbox">sandbox</a>
            		</li>

                    <li><a href="#worker-src">worker-src</a>
            		</li>

                    <li><a href="#manifest-src">manifest-src</a>
            		</li>
                </ol>
            		</li>

                    <li><a href="#should-not">SHOULD NOT</a>
            
                <ol>
                    
                    <li><a href="#object-src">object-src</a>
            		</li>

                    <li><a href="#frame-src">frame-src</a>
            		</li>

                    <li><a href="#child-src">child-src</a>
            		</li>
                </ol>
            		</li>

                    <li><a href="#references">References</a>
            		</li>
                </ol>
            </div>
        </nav>
      </div>

      <div class="app-pane__main-content">
        <div class="nhsuk-back-link no-js">  <a class="nhsuk-back-link__link" href="javascript:history.back()">
  <svg class="nhsuk-icon nhsuk-icon__chevron-left" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" height="24" width="24">
    <path d="M8.5 12c0-.3.1-.5.3-.7l5-5c.4-.4 1-.4 1.4 0s.4 1 0 1.4L10.9 12l4.3 4.3c.4.4.4 1 0 1.4s-1 .4-1.4 0l-5-5c-.2-.2-.3-.4-.3-.7z"></path>
  </svg>
  Go back</a>
</div>

      
        <div class="nhsbsa-article-header">
          <h1 class="nhsuk-heading-xl">
            Content Security Policy
          </h1>
            <strong class="nhsuk-tag nhsuk-tag--yellow">
  REVIEW
</strong>


        </div>
      
<details class="nhsuk-details nhsuk-expander">
  <summary class="nhsuk-details__summary">
    <span class="nhsuk-details__summary-text">
      <h2 class="nhsbsa-details__summary-heading nhsuk-heading-s">Issue sheet</h2>
    </span>
  </summary>
  <div class="nhsuk-details__text">
    <table>
      <tr>
      <th>Document location</th>
      <td><a href="/nhsbsa-digital-playbook/security/content-security-policy/">/nhsbsa-digital-playbook/security/content-security-policy/</a></td>
      </tr>
      <tr>
      <th>Title</th>
      <td>Content Security Policy</td>
      </tr>
      <tr>
      <th>Author</th>
      <td>Professional Lead Software Development</td>
      </tr>
      <tr>
      <th>Owner</th>
      <td>Security Operations Manager</td>
      </tr>
      <tr>
      <th>Issued to</th>
      <td>DDaT</td>
      </tr>
      <tr>
      <th>Approved by</th>
      <td>DA</td>
      </tr>
      <tr>
      <th>Approved</th>
      <td>
        <time datetime="2022-06-30T00:00:00.000Z">30 June 2022</time>
      </td>
      </tr>
      <tr>
      <th>Last reviewed</th>
      <td>
        <time datetime="2022-06-30T00:00:00.000Z">30 June 2022</time>
      </td>
      </tr>
      <tr>
      <th>Next review due</th>
      <td>
        <time datetime="2022-12-30T00:00:00.000Z">30 December 2022</time>
      </td>
      </tr>
    </table>

      <h3 id="revision-history" tabindex="-1" class="nhsuk-heading-s"><a class="header-anchor" href="#revision-history">Revision history</a></h3>
      <table>
        <tr>
          <th>Version</th>
          <th>Date</th>
          <th>Amended by</th>
          <th>Approved by</th>
          <th>Details</th>
        </tr>
        <tr>
        <td>1.0</td>
        <td>
          <time datetime="2022-06-24T00:00:00.000Z">24 June 2022</time>
        </td>
        <td>PT</td>
        <td>AW</td>
        <td>Initial release</td>
        </tr>
        <tr>
        <td>1.1</td>
        <td>
          <time datetime="2022-09-17T00:00:00.000Z">17 September 2022</time>
        </td>
        <td>PT</td>
        <td>AW</td>
        <td>CSP `navigate-to` directive removed from CSP L3 working draft</td>
        </tr>
      </table>
  </div>
</details>

<p>A Content Security Policy (CSP) helps prevent unwanted content from being injected/loaded into your webpages. This can mitigate cross-site scripting (XSS) vulnerabilities, clickjacking, formjacking, malicious frames, unwanted trackers, and other web client-side attacks.</p>
<p>If you want to learn how CSP works, check out:</p>
<ul>
<li><a href="https://www.html5rocks.com/en/tutorials/security/content-security-policy/" target="_blank" rel="noopener">Web.dev guide to CSP</a></li>
<li><a href="https://content-security-policy.com/" target="_blank" rel="noopener">Content Security Policy quick reference guide</a></li>
<li><a href="https://www.w3.org/TR/CSP/" target="_blank" rel="noopener">W3C Content Security Policy specification</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy" target="_blank" rel="noopener">MDN Content Security Policy reference</a></li>
<li><a href="https://csp.withgoogle.com/docs/index.html" target="_blank" rel="noopener">Google’s guidance on CSP</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Content_Security_Policy_Cheat_Sheet.html" target="_blank" rel="noopener">OWASP CSP Cheat sheet</a></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Consult a security expert</p>
<p>The advice and recommended values provided here should be taken as guidance only. Security headers can be complicated, with compounding effects depending on your web application and the diversity of user devices.</p>
<ul>
<li>Consult a security expert before applying values</li>
<li>Follow a sensible route to live where changes are tested in a pre-production environment</li>
<li>Thoroughly test your application against your expected devices</li>
</ul>
<p>Readers should be careful when copying and pasting code from any website, this site included. NHS Business Services Authority, its employees and its representatives accept no liability for damage caused by the misuse, either intentional or unintentional, of the information presented in its articles.</p>
</div>
<h2 id="start-early" tabindex="-1"><a class="header-anchor" href="#start-early">Start early</a></h2>
<p>Developing a site with CSP from the outset is much easier than retrofitting CSP to an existing site.</p>
<h2 id="csp-header" tabindex="-1"><a class="header-anchor" href="#csp-header">CSP Header</a></h2>
<p>Sending the standard <code>Content-Security-Policy</code> header as well as earlier <code>X-Content-Security-Policy</code> or <code>X-Webkit-CSP</code> headers causes unexpected behaviours on some browsers. Avoid using the deprecated <code>X-*</code> headers.</p>
<p>Chrome dev-tools hides the <code>X-</code> style CSP response headers in preference to the standard <code>Content-Security-Policy</code>, even when they are sent. Use this curl command to test whether your site is sending the deprecated headers:</p>
<pre class="language-bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">--head</span> <span class="token operator">&lt;</span>URL<span class="token operator">></span></code></pre>
<h2 id="csp-levels" tabindex="-1"><a class="header-anchor" href="#csp-levels">CSP levels</a></h2>
<p>CSP is an evolving standard, and with each new release comes tighter controls to protect users. These are referred to as CSP Levels. We aim to provide as secure an experience as possible with the browsers available to our users.</p>
<p>Design to Content Security Policy level 2 and above. At the time of writing, all modern browsers support Level 2. IE 11 supports parts of Level 1 and it relies on the deprecated and dangerous <code>X-Content-Security-Policy</code>. It can therefore be safely ignored from scope of the CSP.</p>
<h2 id="browser-support" tabindex="-1"><a class="header-anchor" href="#browser-support">Browser support</a></h2>
<p>To check CSP level support in browsers refer to the CanIUse website:</p>
<ul>
<li><a href="https://caniuse.com/contentsecuritypolicy" target="_blank" rel="noopener">CSP Level 1</a></li>
<li><a href="https://caniuse.com/contentsecuritypolicy2" target="_blank" rel="noopener">CSP Level 2</a></li>
<li>Browser support for CSP Level 3 is currently undocumented on CanIUse.</li>
</ul>
<p>Cross reference our <a href="https://nhsbsauk.sharepoint.com/sites/Digital872/SitePages/NHSBSA-Compatibility-testing-coverage.aspx" target="_blank" rel="noopener">supported browsers</a> to get a clear understanding of which Level we must support.</p>
<h2 id="csp-evaluator" tabindex="-1"><a class="header-anchor" href="#csp-evaluator">CSP Evaluator</a></h2>
<p>To check what your CSP states at the different levels, and what the security implications are, use the <a href="https://csp-evaluator.withgoogle.com/" target="_blank" rel="noopener">CSP Evaluator</a> from Google.</p>
<p>Be sure to check your CSP at level 2 and 3 (referred to as Versions in the evaluator)</p>
<h2 id="hash-and-nonce" tabindex="-1"><a class="header-anchor" href="#hash-and-nonce">Hash and nonce</a></h2>
<p>Some of the CSP directives can use a hash or a nonce value. A hash is a SHA hash of a resource such as a script file. A cryptographic nonce is a unique value that is generated once per request. Using a hash (preferred) or nonce will improve resilience to attacks. If you use a directive that supports them, then you should do so.</p>
<p>If using a nonce, be sure to understand the <a href="https://www.w3.org/TR/CSP/#security-considerations" target="_blank" rel="noopener">security implications</a> and talk to our security team.</p>
<h2 id="framework-support" tabindex="-1"><a class="header-anchor" href="#framework-support">Framework support</a></h2>
<h3 id="nodejs" tabindex="-1"><a class="header-anchor" href="#nodejs">Node.js</a></h3>
<p><a href="https://www.npmjs.com/package/helmet-csp" target="_blank" rel="noopener">Helmet-CSP</a> is an extension to the <a href="https://www.npmjs.com/package/helmet" target="_blank" rel="noopener">Helmet.js</a> security library. It will generate dynamic CSPs for you through configuration, and has support for nonces.</p>
<p>Example Expess.js/Helmet.js configuration that’s aligned with the BSA HTTP Security Headers:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> helmet <span class="token keyword">from</span> <span class="token string">'helmet'</span><span class="token punctuation">;</span>

<span class="token operator">...</span>

<span class="token comment">// optional nonce middleware</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span>locals<span class="token punctuation">.</span>scriptNonce <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token function">v4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'base64'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span>
  <span class="token string-property property">'object-src'</span><span class="token operator">:</span> objectSrc<span class="token punctuation">,</span>
  <span class="token string-property property">'script-src'</span><span class="token operator">:</span> scriptSrc<span class="token punctuation">,</span>
  <span class="token operator">...</span>defaultDirectives
<span class="token punctuation">}</span> <span class="token operator">=</span> helmet<span class="token punctuation">.</span>contentSecurityPolicy<span class="token punctuation">.</span><span class="token function">getDefaultDirectives</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  helmet<span class="token punctuation">.</span><span class="token function">contentSecurityPolicy</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">directives</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>defaultDirectives<span class="token punctuation">,</span>
      <span class="token string-property property">'default-src'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"'none'"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string-property property">'form-action'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"'self'"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string-property property">'frame-ancestors'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"'none'"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string-property property">'plugin-types'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"'none'"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string-property property">'prefetch-src'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"'none'"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string-property property">'script-src'</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token operator">...</span>scriptSrc<span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">'nonce-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>res<span class="token punctuation">.</span>locals<span class="token punctuation">.</span>scriptNonce<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string-property property">'style-src'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"'self'"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>helmet<span class="token punctuation">.</span><span class="token function">crossOriginEmbedderPolicy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>helmet<span class="token punctuation">.</span><span class="token function">crossOriginOpenerPolicy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  helmet<span class="token punctuation">.</span><span class="token function">crossOriginResourcePolicy</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">policy</span><span class="token operator">:</span> <span class="token string">'same-site'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>helmet<span class="token punctuation">.</span><span class="token function">dnsPrefetchControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>helmet<span class="token punctuation">.</span><span class="token function">frameguard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>helmet<span class="token punctuation">.</span><span class="token function">hidePoweredBy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  helmet<span class="token punctuation">.</span><span class="token function">hsts</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">maxAge</span><span class="token operator">:</span> <span class="token number">31536000</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>helmet<span class="token punctuation">.</span><span class="token function">ieNoOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>helmet<span class="token punctuation">.</span><span class="token function">noSniff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>helmet<span class="token punctuation">.</span><span class="token function">originAgentCluster</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  helmet<span class="token punctuation">.</span><span class="token function">referrerPolicy</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">policy</span><span class="token operator">:</span> <span class="token string">'strict-origin-when-cross-origin'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>helmet<span class="token punctuation">.</span><span class="token function">xssFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h3 id="java/spring" tabindex="-1"><a class="header-anchor" href="#java/spring">Java/Spring</a></h3>
<p>Spring-security only has support for a static CSP. This is insufficient for generation of a nonce/hash. See <a href="https://techblog.bozho.net/content-security-policy-nonce-with-spring-security/" target="_blank" rel="noopener">this article</a> for details of how to support CSPs with dynamic nonce generation, substitution in the CSP and usage in an HTML template. A similar technique could be used for hashing.</p>
<h2 id="inline-scripts" tabindex="-1"><a class="header-anchor" href="#inline-scripts">Inline scripts</a></h2>
<p>Try to avoid inline scripts.</p>
<p>If your application uses inline scripts such as the usual Google Analytics and/or Google Tag Manager snippets:</p>
<ul>
<li>
<p>Extract the inline script into file hosted by your service and allow that to load using the ‘self’ value</p>
<p>otherwise…</p>
</li>
<li>
<p>Ese a <code>nonce-*</code> value and add a nonce attribute to the inline script<br>
You may need to pass the nonce value downstream to the Google scripts loaded from the inline script.<br>
See this article for further detail: <a href="https://developers.google.com/tag-platform/tag-manager/web/csp" target="_blank" rel="noopener">Use Tag Manager with a Content Security Policy</a></p>
</li>
</ul>
<h2 id="reporting" tabindex="-1"><a class="header-anchor" href="#reporting">Reporting</a></h2>
<p>While developing a CSP it can be useful to use the <code>Content-Security-Policy-Report-Only</code> header. The browser will report violations of the CSP without breaking the web application. Fix the policy or the application before switching to use the <code>Content-Security-Policy</code> header.</p>
<p>It is a good idea to release the CSP in report only mode to gain the confidence that no issues have been found in the wild.</p>
<p>Even after switching to an enforcing CSP, it is useful to receive reports. This will alert to any problems that are introduced, or to attacks being made in the wild. Add the report-uri and report-to directives to the CSP (see below).</p>
<h2 id="example-csp" tabindex="-1"><a class="header-anchor" href="#example-csp">Example CSP</a></h2>
<p>This is an example CSP to use as an initial basis for development.</p>
<p>Note:</p>
<ul>
<li>Use of Google Analytics and Google Tag Manager: Remove if not required</li>
<li>Use of nonce: Remove if not supported in your framework</li>
</ul>
<pre class="language-csp"><code class="language-csp"><span class="token directive property">default-src</span> <span class="token none keyword">'none'</span><span class="token punctuation">;</span>
<span class="token directive property">frame-ancestors</span> <span class="token none keyword">'none'</span><span class="token punctuation">;</span>
<span class="token directive property">base-uri</span> <span class="token keyword safe">'self'</span><span class="token punctuation">;</span>
<span class="token directive property">form-action</span> <span class="token keyword safe">'self'</span><span class="token punctuation">;</span>
<span class="token directive property">plugin-types</span> <span class="token none keyword">'none'</span><span class="token punctuation">;</span>
<span class="token directive property">prefetch-src</span> <span class="token none keyword">'none'</span><span class="token punctuation">;</span>
<span class="token directive property">script-src</span> <span class="token keyword safe">'self'</span> 'nonce-{nonce}'<span class="token punctuation">;</span>
<span class="token directive property">style-src</span> <span class="token keyword safe">'self'</span> 'nonce-{nonce}'<span class="token punctuation">;</span>
<span class="token directive property">img-src</span> <span class="token keyword safe">'self'</span> 'nonce-{nonce}' <span class="token host url">https://www.google-analytics.com</span> <span class="token host url">https://www.googletagmanager.com</span><span class="token punctuation">;</span>
<span class="token directive property">font-src</span> <span class="token keyword safe">'self'</span> 'nonce-{nonce}' <span class="token host url">https://assets.nhs.uk</span><span class="token punctuation">;</span>
<span class="token directive property">connect-src</span> <span class="token keyword safe">'self'</span> 'nonce-{nonce}' <span class="token host url">https://www.google-analytics.com</span> <span class="token host url">https://www.googletagmanager.com</span><span class="token punctuation">;</span>
<span class="token directive property">report-uri</span> TBD<span class="token punctuation">;</span></code></pre>
<h2 id="must" tabindex="-1"><a class="header-anchor" href="#must">MUST</a></h2>
<div class="card">
<h3 id="default-src" tabindex="-1"><a class="header-anchor" href="#default-src">default-src</a></h3>
<dl>
<dt>Reference</dt>
<dd>
<ul>
<li><a href="https://content-security-policy.com/default-src/" target="_blank" rel="noopener">https://content-security-policy.com/default-src/</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/default-src" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/default-src</a></li>
<li><a href="https://www.w3.org/TR/CSP/#directive-default-src" target="_blank" rel="noopener">https://www.w3.org/TR/CSP/#directive-default-src</a></li>
</ul>
</dd>
<dt>Guidance</dt>
<dd>
<p>Adopt the principle of least privilege by using a value of <code>'none'</code>, setting the default for:</p>
<ul>
<li><a href="#script-src">script-src</a></li>
<li><a href="#style-src">style-src</a></li>
<li><a href="#font-src">font-src</a></li>
<li><a href="#img-src">img-src</a></li>
<li><a href="#connect-src">connect-src</a></li>
<li><a href="#worker-src">worker-src</a></li>
<li><a href="#object-src">object-src</a></li>
<li><a href="#media-src">media-src</a></li>
<li><a href="#manifest-src">manifest-src</a></li>
<li><a href="#frame-src">frame-src</a></li>
<li><a href="#prefetch-src">prefetch-src</a></li>
<li><a href="#child-src">child-src</a></li>
</ul>
<p>You may then re-enable specific <code>*-src</code> directives as required.</p>
</dd>
<dt>Recommended value</dt>
<dd>
<p><code>'none'</code></p>
</dd>
</dl>
</div>
<div class="card">
<h3 id="frame-ancestors" tabindex="-1"><a class="header-anchor" href="#frame-ancestors">frame-ancestors</a></h3>
<dl>
<dt>Reference</dt>
<dd>
<p>Defines valid sources for embedding the resource using <code>&lt;frame&gt;</code>, <code>&lt;iframe&gt;</code>, <code>&lt;object&gt;</code>, <code>&lt;embed&gt;</code>, <code>&lt;applet&gt;</code>.<br>
Setting this directive to <code>'none'</code> should be roughly equivalent to <code>X-Frame-Options: DENY</code></p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors</a></li>
<li><a href="https://www.w3.org/TR/CSP/#directive-frame-ancestors" target="_blank" rel="noopener">https://www.w3.org/TR/CSP/#directive-frame-ancestors</a></li>
</ul>
</dd>
<dt>Guidance</dt>
<dd>
<p>Use recommended value of <code>'none'</code></p>
</dd>
<dt>Recommended value</dt>
<dd>
<p><code>'none'</code></p>
</dd>
</dl>
</div>
<div class="card">
<h3 id="base-uri" tabindex="-1"><a class="header-anchor" href="#base-uri">base-uri</a></h3>
<dl>
<dt>Reference</dt>
<dd>
<p>Defines a set of allowed URLs which can be used in the src attribute of a HTML base tag.</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/base-uri" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/base-uri</a></li>
<li><a href="https://www.w3.org/TR/CSP/#directive-base-uri" target="_blank" rel="noopener">https://www.w3.org/TR/CSP/#directive-base-uri</a></li>
</ul>
</dd>
<dt>Guidance</dt>
<dd>
<p>Use recommended value of <code>'self'</code><br>
Consult with security team if another base URI is required</p>
</dd>
<dt>Recommended value</dt>
<dd>
<p><code>'self'</code></p>
</dd>
</dl>
</div>
<div class="card">
<h3 id="form-action" tabindex="-1"><a class="header-anchor" href="#form-action">form-action</a></h3>
<dl>
<dt>Reference</dt>
<dd>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/form-action" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/form-action</a></li>
<li><a href="https://www.w3.org/TR/CSP/#directive-form-action" target="_blank" rel="noopener">https://www.w3.org/TR/CSP/#directive-form-action</a></li>
</ul>
</dd>
<dt>Guidance</dt>
<dd>Form actions should be handled by the same origin as the application.<br>
Use recommended value of <code>'self'</code><br>
Consult with security team if another form-action is required</dd>
<dt>Recommended value</dt>
<dd><code>'self'</code></dd>
</dl>
</div>
<div class="card">
<h3 id="plugin-types" tabindex="-1"><a class="header-anchor" href="#plugin-types">plugin-types</a></h3>
<dl>
<dt>Reference</dt>
<dd>
<p>Defines valid MIME types for plugins invoked via <code>&lt;object&gt;</code> and <code>&lt;embed&gt;</code>. To load an <code>&lt;applet&gt;</code> you must specify <code>application/x-java-applet</code>.</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/plugin-types" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/plugin-types</a></li>
</ul>
</dd>
<dt>Guidance</dt>
<dd>
<p>Use recommended value of <code>'none'</code><br>
Consult with security team if a plugin is required</p>
</dd>
<dt>Recommended value</dt>
<dd>
<p><code>'none'</code></p>
</dd>
</dl>
</div>
<div class="card">
<h3 id="prefetch-src" tabindex="-1"><a class="header-anchor" href="#prefetch-src">prefetch-src</a></h3>
<dl>
<dt>Reference</dt>
<dd>
<p>Defines valid sources for request prefetch and prerendering, for example via the link tag with <code>rel=&quot;prefetch&quot;</code> or <code>rel=&quot;prerender&quot;</code></p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/prefetch-src" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/prefetch-src</a></li>
</ul>
</dd>
<dt>Guidance</dt>
<dd>
<p>Use recommended value of <code>'none'</code><br>
Consult with security team if prefetch is required</p>
</dd>
<dt>Recommended value</dt>
<dd>
<p><code>'none'</code></p>
</dd>
</dl>
</div>
<h2 id="should" tabindex="-1"><a class="header-anchor" href="#should">SHOULD</a></h2>
<div class="card">
<h3 id="script-src" tabindex="-1"><a class="header-anchor" href="#script-src">script-src</a></h3>
<dl>
<dt>Reference</dt>
<dd>
<ul>
<li><a href="https://content-security-policy.com/script-src/" target="_blank" rel="noopener">https://content-security-policy.com/script-src/</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/script-src" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/script-src</a></li>
<li><a href="https://www.w3.org/TR/CSP/#directive-script-src" target="_blank" rel="noopener">https://www.w3.org/TR/CSP/#directive-script-src</a></li>
</ul>
</dd>
<dt>Guidance</dt>
<dd>Add additional domains such as Google Analytics/Tag Manager only when needed.<br>
Avoid <code>'unsafe-inline'</code> and <code>'unsafe-eval'</code></dd>
<dt>Recommended value</dt>
<dd><code>'self'</code></dd>
</dl>
</div>
<div class="card">
<h3 id="style-src" tabindex="-1"><a class="header-anchor" href="#style-src">style-src</a></h3>
<dl>
<dt>Reference</dt>
<dd>
<ul>
<li><a href="https://content-security-policy.com/style-src/" target="_blank" rel="noopener">https://content-security-policy.com/style-src/</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/style-src" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/style-src</a></li>
<li><a href="https://www.w3.org/TR/CSP/#directive-style-src" target="_blank" rel="noopener">https://www.w3.org/TR/CSP/#directive-style-src</a></li>
</ul>
</dd>
<dt>Guidance</dt>
<dd>All styles should be defined in separate CSS files and served from the same origin.<br>
Avoid <code>'unsafe-inline'</code></dd>
<dt>Recommended value</dt>
<dd><code>'self'</code></dd>
</dl>
</div>
<div class="card">
<h3 id="img-src" tabindex="-1"><a class="header-anchor" href="#img-src">img-src</a></h3>
<dl>
<dt>Reference</dt>
<dd>
<ul>
<li><a href="https://content-security-policy.com/img-src/" target="_blank" rel="noopener">https://content-security-policy.com/img-src/</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/img-src" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/img-src</a></li>
<li><a href="https://www.w3.org/TR/CSP/#directive-img-src" target="_blank" rel="noopener">https://www.w3.org/TR/CSP/#directive-img-src</a></li>
</ul>
</dd>
<dt>Guidance</dt>
<dd>Additional domains such as Google Analytics/Tag Manager may be needed for beacon pixels.<br>
Avoid <code>'unsafe-inline'</code></dd>
<dt>Recommended value</dt>
<dd><code>'self'</code></dd>
</dl>
</div>
<div class="card">
<h3 id="font-src" tabindex="-1"><a class="header-anchor" href="#font-src">font-src</a></h3>
<dl>
<dt>Reference</dt>
<dd>
<ul>
<li><a href="https://content-security-policy.com/font-src/" target="_blank" rel="noopener">https://content-security-policy.com/font-src/</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/font-src" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/font-src</a></li>
<li><a href="https://www.w3.org/TR/CSP/#directive-font-src" target="_blank" rel="noopener">https://www.w3.org/TR/CSP/#directive-font-src</a></li>
</ul>
</dd>
<dt>Guidance</dt>
<dd>Fonts should be hosted by the NHS assets CDN.<br>
Avoid <code>'unsafe-inline'</code></dd>
<dt>Recommended value</dt>
<dd><code>https://assets.nhs.uk</code><br>
and/or<br>
<code>'self'</code></dd>
</dl>
</div>
<div class="card">
<h3 id="report-uri" tabindex="-1"><a class="header-anchor" href="#report-uri">report-uri</a></h3>
<dl>
<dt>Reference</dt>
<dd>
<p>Instructs the browser to POST a reports of policy failures to this URI. You can also use <code>Content-Security-Policy-Report-Only</code> as the HTTP header name to instruct the browser to only send reports (does not block anything). This directive is deprecated in CSP Level 3 in favor of the <code>report-to</code> directive.</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-uri" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-uri</a></li>
<li><a href="https://www.w3.org/TR/CSP/#directive-report-uri" target="_blank" rel="noopener">https://www.w3.org/TR/CSP/#directive-report-uri</a></li>
</ul>
</dd>
<dt>Guidance</dt>
<dd>
<p>It is useful to report violations of the CSP in development and live running of a CSP.</p>
</dd>
<dt>Recommended value</dt>
<dd>
<p>TBD</p>
</dd>
</dl>
</div>
<h2 id="could" tabindex="-1"><a class="header-anchor" href="#could">COULD</a></h2>
<div class="card">
<h3 id="connect-src" tabindex="-1"><a class="header-anchor" href="#connect-src">connect-src</a></h3>
<dl>
<dt>Reference</dt>
<dd>
<ul>
<li><a href="https://content-security-policy.com/connect-src/" target="_blank" rel="noopener">https://content-security-policy.com/connect-src/</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/connect-src" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/connect-src</a></li>
<li><a href="https://www.w3.org/TR/CSP/#directive-connect-src" target="_blank" rel="noopener">https://www.w3.org/TR/CSP/#directive-connect-src</a></li>
</ul>
</dd>
<dt>Guidance</dt>
<dd>
<p><code>'self'</code> is only required when client side application Javascript requires access to additional resources such as a web-service.</p>
<p>Add additional domains such as Google Analytics/Tag Manager when needed.</p>
</dd>
<dt>Recommended value</dt>
<dd>
<p>with GA/GTM<br>
<code>https://www.googletagmanager.com https://www.google-analytics.com</code></p>
</dd>
</dl>
</div>
<div class="card">
<h3 id="media-src" tabindex="-1"><a class="header-anchor" href="#media-src">media-src</a></h3>
<dl>
<dt>Reference</dt>
<dd>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/media-src" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/media-src</a></li>
<li><a href="https://www.w3.org/TR/CSP/#directive-media-src" target="_blank" rel="noopener">https://www.w3.org/TR/CSP/#directive-media-src</a></li>
</ul>
</dd>
<dt>Guidance</dt>
<dd>Media can be useful, but large binary content should be served from a CDN external to the application.</dd>
<dt>Recommended value</dt>
<dd>CDN origin</dd>
</dl>
</div>
<div class="card">
<h3 id="upgrade-insecure-requests" tabindex="-1"><a class="header-anchor" href="#upgrade-insecure-requests">upgrade-insecure-requests</a></h3>
<dl>
<dt>Reference</dt>
<dd>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/upgrade-insecure-requests" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/upgrade-insecure-requests</a></li>
<li><a href="https://www.w3.org/TR/upgrade-insecure-requests/#delivery" target="_blank" rel="noopener">https://www.w3.org/TR/upgrade-insecure-requests/#delivery</a></li>
</ul>
</dd>
<dt>Guidance</dt>
<dd>Use this directive when resources could be served over insecure HTTP, but you wish to migrate over to HTTPS without the effort of fixing the pages.</dd>
<dt>Recommended value</dt>
<dd>N/A</dd>
</dl>
</div>
<div class="card">
<h3 id="report-to" tabindex="-1"><a class="header-anchor" href="#report-to">report-to</a></h3>
<dl>
<dt>Reference</dt>
<dd>
<p>Defines a reporting group name defined by a Report-To HTTP response header. See the Reporting API for more info.</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-to" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-to</a></li>
<li><a href="https://www.w3.org/TR/CSP/#directive-report-to" target="_blank" rel="noopener">https://www.w3.org/TR/CSP/#directive-report-to</a></li>
</ul>
</dd>
<dt>Guidance</dt>
<dd>
<p>It is useful to report violations of the CSP in development and live running of a CSP.</p>
</dd>
<dt>Recommended value</dt>
<dd>
<p>TBD</p>
</dd>
</dl>
</div>
<div class="card">
<h3 id="sandbox" tabindex="-1"><a class="header-anchor" href="#sandbox">sandbox</a></h3>
<dl>
<dt>Reference</dt>
<dd>N/A</dd>
<dt>Guidance</dt>
<dd>Consult with security team</dd>
<dt>Recommended value</dt>
<dd>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/sandbox" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/sandbox</a></li>
<li><a href="https://www.w3.org/TR/CSP/#directive-sandbox" target="_blank" rel="noopener">https://www.w3.org/TR/CSP/#directive-sandbox</a></li>
</ul>
</dd>
</dl>
</div>
<div class="card">
<h3 id="worker-src" tabindex="-1"><a class="header-anchor" href="#worker-src">worker-src</a></h3>
<dl>
<dt>Reference</dt>
<dd>
<p>Restricts the URLs which may be loaded as a Worker, SharedWorker or ServiceWorker.</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/worker-src" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/worker-src</a></li>
<li><a href="https://www.w3.org/TR/CSP/#directive-worker-src" target="_blank" rel="noopener">https://www.w3.org/TR/CSP/#directive-worker-src</a></li>
</ul>
</dd>
<dt>Guidance</dt>
<dd>
<p><code>'self'</code> is only required when client side application Javascript requires access to additional resources such as a web-service from a worker thread.<br>
Otherwise avoid usage and fallback to the <code>default-src 'none';</code></p>
</dd>
<dt>Recommended value</dt>
<dd>
<p>N/A</p>
</dd>
</dl>
</div>
<div class="card">
<h3 id="manifest-src" tabindex="-1"><a class="header-anchor" href="#manifest-src">manifest-src</a></h3>
<dl>
<dt>Reference</dt>
<dd>
<p>The web app manifest is a JSON file that tells the browser about your Progressive Web App and how it should behave when installed on the user’s desktop or mobile device. A typical manifest file includes the app name, the icons the app should use, and the URL that should be opened when the app is launched.</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/manifest-src" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/manifest-src</a></li>
<li><a href="https://www.w3.org/TR/CSP/#directive-manifest-src" target="_blank" rel="noopener">https://www.w3.org/TR/CSP/#directive-manifest-src</a></li>
</ul>
</dd>
<dt>Guidance</dt>
<dd>
<p>Only used by progressive web applications<br>
Otherwise avoid usage and fallback to the <code>default-src 'none';</code></p>
</dd>
<dt>Recommended value</dt>
<dd>
<p>N/A</p>
</dd>
</dl>
</div>
<h2 id="should-not" tabindex="-1"><a class="header-anchor" href="#should-not">SHOULD NOT</a></h2>
<div class="card">
<h3 id="object-src" tabindex="-1"><a class="header-anchor" href="#object-src">object-src</a></h3>
<dl>
<dt>Reference</dt>
<dd>
<p>N/A</p>
</dd>
<dt>Guidance</dt>
<dd>
<p>Sources of plugins such as <code>&lt;object&gt;</code>, <code>&lt;embed&gt;</code> or <code>&lt;applet&gt;</code><br>
There are rarely any times that a modern web application will require this, so avoid usage and fallback to the <code>default-src 'none';</code><br>
Consult with security team before use</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/object-src" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/object-src</a></li>
<li><a href="https://www.w3.org/TR/CSP/#object-src" target="_blank" rel="noopener">https://www.w3.org/TR/CSP/#object-src</a></li>
</ul>
</dd>
<dt>Recommended value</dt>
<dd>
<p>N/A</p>
</dd>
</dl>
</div>
<div class="card">
<h3 id="frame-src" tabindex="-1"><a class="header-anchor" href="#frame-src">frame-src</a></h3>
<dl>
<dt>Reference</dt>
<dd>
<p>Defines valid sources for loading frames. In CSP Level 2 <code>frame-src</code> was deprecated in favor of the <code>child-src</code> directive. CSP Level 3, has undeprecated <code>frame-src</code> and it will continue to defer to <code>child-src</code> if not present.</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-src" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-src</a></li>
<li><a href="https://www.w3.org/TR/CSP/#directive-frame-src" target="_blank" rel="noopener">https://www.w3.org/TR/CSP/#directive-frame-src</a></li>
</ul>
</dd>
<dt>Guidance</dt>
<dd>
<p>Web applications should avoid use of <code>&lt;frame&gt;</code> and <code>&lt;iframe&gt;</code> and fallback to the <code>default-src 'none';</code><br>
Social media integration may require use of iframes.<br>
Consult with security team before use</p>
</dd>
<dt>Recommended value</dt>
<dd>
<p>N/A</p>
</dd>
</dl>
</div>
<div class="card">
<h3 id="child-src" tabindex="-1"><a class="header-anchor" href="#child-src">child-src</a></h3>
<dl>
<dt>Reference</dt>
<dd>
<p>Defines valid sources for web workers and nested browsing contexts loaded using elements such as <code>&lt;frame&gt;</code> and <code>&lt;iframe&gt;</code></p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/child-src" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/child-src</a></li>
<li><a href="https://www.w3.org/TR/CSP/#directive-child-src" target="_blank" rel="noopener">https://www.w3.org/TR/CSP/#directive-child-src</a></li>
</ul>
</dd>
<dt>Guidance</dt>
<dd>
<p>Web applications should avoid use of <code>&lt;frame&gt;</code> and <code>&lt;iframe&gt;</code> and fallback to the <code>default-src 'none';</code><br>
Social media integration may require use of iframes.<br>
Consult with security team before use</p>
</dd>
<dt>Recommended value</dt>
<dd>
<p>N/A</p>
</dd>
</dl>
</div>
<h2 id="references" tabindex="-1"><a class="header-anchor" href="#references">References</a></h2>
<ul>
<li><a href="https://www.w3.org/TR/CSP/" target="_blank" rel="noopener">W3C CSP specification</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy" target="_blank" rel="noopener">MDN Content Security Policy reference</a></li>
<li><a href="https://www.html5rocks.com/en/tutorials/security/content-security-policy/" target="_blank" rel="noopener">Web.dev guide to CSP</a></li>
<li><a href="https://csp.withgoogle.com/docs/index.html" target="_blank" rel="noopener">CSP with Google</a></li>
<li><a href="https://csp.withgoogle.com/docs/strict-csp.html" target="_blank" rel="noopener">Google - Strict Content Security Policy</a></li>
<li><a href="https://csp-evaluator.withgoogle.com/" target="_blank" rel="noopener">Google - CSP Evaluator</a></li>
<li><a href="https://developers.google.com/tag-platform/tag-manager/web/csp" target="_blank" rel="noopener">Google Developers - Using Google Tag Manager with a Content Security Policy</a></li>
<li><a href="https://developers.google.com/web/fundamentals/security/csp" target="_blank" rel="noopener">Google fundamentals - Content security policy</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Content_Security_Policy_Cheat_Sheet.html" target="_blank" rel="noopener">Content Security Policy - OWASP Cheat Sheet Series</a></li>
<li><a href="https://content-security-policy.com/" target="_blank" rel="noopener">Content-Security-Policy</a></li>
<li><a href="https://caniuse.com/?search=csp" target="_blank" rel="noopener">Can I use… CSP</a></li>
<li><a href="https://www.npmjs.com/package/helmet-csp" target="_blank" rel="noopener">Helmet-csp</a></li>
<li><a href="https://dropbox.tech/security/on-csp-reporting-and-filtering" target="_blank" rel="noopener">CSP On Reporting and Filtering</a></li>
</ul>

        <hr>
        <h2 class="nhsuk-heading-l header-anchor" id="improve-the-playbook">Improve the playbook</h2>
        <p>If you spot anything factually incorrect with this page or have ideas for improvement,
          please share your suggestions.</p>

        <p>Before you start, you will need a <a href="https://github.com/join?source=login" target="_blank" rel="noopener">GitHub account</a>.
        Github is an open forum where we collect feedback.</p>
        

<div class="nhsuk-action-link">
  <a class="nhsuk-action-link__link" href="https://github.com/nhsbsa/nhsbsa-digital-playbook/discussions/new?category=security&amp;template=General-Playbook-Ideas.md&amp;title=Change%20to%20page%20&#39;%2Fsecurity%2Fcontent-security-policy&#39;%20" target="_blank" rel="noopener">
    <svg class="nhsuk-icon nhsuk-icon__arrow-right-circle" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" width="36" height="36">
      <path d="M0 0h24v24H0z" fill="none"></path>
      <path d="M12 2a10 10 0 0 0-9.95 9h11.64L9.74 7.05a1 1 0 0 1 1.41-1.41l5.66 5.65a1 1 0 0 1 0 1.42l-5.66 5.65a1 1 0 0 1-1.41 0 1 1 0 0 1 0-1.41L13.69 13H2.05A10 10 0 1 0 12 2z"></path>
    </svg>
    <span class="nhsuk-action-link__text">Suggest a change to this page</span>
  </a>
</div>



        <div class="nhsbsa-article--date">
    <p class="nhsuk-body-s nhsuk-u-secondary-text-color nhsuk-u-margin-bottom-0">
      Published: <time datetime="2024-01-13T14:52:36.000Z">13 January 2024</time>
    </p>
    <p class="nhsuk-body-s nhsuk-u-secondary-text-color nhsuk-u-margin-bottom-0">
      Last reviewed: <time datetime="2022-06-30T00:00:00.000Z">30 June 2022</time>
    </p>
    <p class="nhsuk-body-s nhsuk-u-secondary-text-color nhsuk-u-margin-bottom-0">
      Next review due: <time datetime="2022-12-30T00:00:00.000Z">30 December 2022</time>
    </p>
</div>


        </div>
      </div>
    </div>
  </div>

    </main>
</div>

    <footer role="contentinfo">
  <div class="nhsuk-footer-container">
    <div class="nhsuk-width-container app-width-container">
      <div class="nhsuk-footer" id="nhsuk-footer">				<h2 class="nhsuk-u-visually-hidden">Support links</h2>
				
				<ul class="nhsuk-footer__list">					<li class="nhsuk-footer__list-item nhsuk-footer-default__list-item"><a class="nhsuk-footer__list-item-link" href="/nhsbsa-digital-playbook/accessibility">Accessibility</a></li>					<li class="nhsuk-footer__list-item nhsuk-footer-default__list-item"><a class="nhsuk-footer__list-item-link" href="https://www.nhsbsa.nhs.uk/contact-us" target="_blank" rel="noopener">Contact us</a></li>					<li class="nhsuk-footer__list-item nhsuk-footer-default__list-item"><a class="nhsuk-footer__list-item-link" href="/nhsbsa-digital-playbook/cookie-policy/">Cookies</a></li>					<li class="nhsuk-footer__list-item nhsuk-footer-default__list-item"><a class="nhsuk-footer__list-item-link" href="https://github.com/nhsbsa/nhsbsa-digital-playbook" target="_blank" rel="noopener">GitHub</a></li>				</ul>
        <p class="nhsuk-footer__copyright">&copy; Crown copyright</p>
      </div>
			<div class="nhsuk-ogl-footer">
				<p class="nhsuk-ogl-footer--text">
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 483.2 195.7" height="17" width="41" focusable="false">
				<path fill="currentColor" d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"></path>
				</svg>
				All content is available under the <a class="nhsuk-footer__list-item-link" href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="noopener" target="_blank">Open Government Licence v3.0</a>, except where otherwise stated.
				</p>
			</div>
    </div>
  </div>
</footer>

    <script src="/nhsbsa-digital-playbook/javascripts/nhsuk.min.js?v=c25341999277"></script>
    <script src="/nhsbsa-digital-playbook/javascripts/application.js?v=13016328ce1d"></script>
    <script src="/nhsbsa-digital-playbook/javascripts/cookie-banner.js?v=d12e888d2db3"></script>

</body>
</html>
